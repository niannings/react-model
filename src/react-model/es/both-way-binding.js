/*! @wlxm/react-model - v0.1.1 - 4/5/2020 https://niannings.github.io */
import{_ as e,u as r,a as n}from"./useStates-c81ffa19.js";import t,{useEffect as o,useCallback as a,Children as i,useMemo as u,cloneElement as d,useRef as c}from"react";import{s as l,g as v}from"./object-63ca3eb8.js";var s=Date.now();function f(r){var n;++s;var o=((n={})["$model-id"]=s.toString(32),n);return function(n){return t.createElement(r,e({},n,o))}}function m(e){for(var r=e._owner;r;){var n=r.pendingProps["$model-id"];if(n)return n;r=r.return}throw new Error("useModel只能在withModel高阶组件下使用～")}var p=new Map;function g(e){void 0===e&&(e={});var n=t.createElement(t.Fragment,null),i=m(n),u=p.get(i)||[],d=u[0],c=u[1],v=r(e),s=v[0],f=v[1];o((function(){return function(){i===n._owner["$model-id"]&&p.delete(i)}}),[]);var g=a((function(e){var r=Object.keys(e)[0];l(s,r,e[r]),c?c(s):f(s)}),[]);return d||p.set(i,[s,g]),p.get(i)}function _(e){var r=m(e),t=p.get(r);return function e(r,t,o){return r?i.map(r,(function(r){var a=v(r,"props._modelname")[0];if(a)return function(e){var r=e.jsxEl,t=e.model,o=e.setModel,a=e.modelName,i=v(r,"props")[0]||{},l=i._prop,s=void 0===l?"value":l,f=i._event,m=void 0===f?"onChange":f,p=i._byevent,g=void 0!==p&&p,_=i._deps,w=void 0===_?[]:_,h=v(t,a)[0],j=n([h],w),E=c((function(e){var r;o(((r={})[a]=g?e.target[s]:e,r))}));return w.length,u((function(){var e;return d(r,((e={})[s]=h||("input"===r.type?"":h),e[m]=E.current,e))}),j)}({jsxEl:r,model:t,setModel:o,modelName:a});var i=v(r,"props.children")[0];return i?d(r,{children:e(i,t,o)}):r})):r}(e,t[0],t[1])}export{_ as useBothWayBinding,g as useModel,f as withModel};
